worker_processes 1;

events {
    worker_connections 1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    sendfile        on;
    keepalive_timeout 65;

    server {
        listen 80;  # Listen on port 80
        server_name localhost;  # Replace with your server name or domain

        # Location for the React application
        location / {
            root /usr/share/nginx/html;  # Ensure this points to the correct directory
            index index.html;  # This should work if index.html exists
            try_files $uri $uri/ /index.html;  # Support for React Router
        }

        # Handle API requests to the Node.js server
        location /api {
            proxy_pass http://jobhub-server:5000;  # Proxy to Node.js server
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection 'upgrade';
            proxy_set_header Host $host;
            proxy_cache_bypass $http_upgrade;
        }
    }
}
